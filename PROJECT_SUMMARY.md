# é¡¹ç›®æ€»ç»“ - CSIRO Pasture Biomass Prediction Baseline

## âœ… å·²å®Œæˆå†…å®¹

### 1. é¡¹ç›®ç»“æ„

```
CSIRO/
â”œâ”€â”€ src/                          # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ dataset.py               # æ•°æ®åŠ è½½å’Œé¢„å¤„ç† (4.6 KB)
â”‚   â”œâ”€â”€ model.py                 # æ¨¡å‹å®šä¹‰ (2.7 KB)
â”‚   â”œâ”€â”€ train.py                 # è®­ç»ƒè„šæœ¬ (10 KB)
â”‚   â””â”€â”€ inference.py             # æ¨ç†è„šæœ¬ (6.8 KB)
â”œâ”€â”€ data/                         # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                     # åŸå§‹æ•°æ®ï¼ˆç”¨æˆ·è‡ªè¡Œæ·»åŠ ï¼‰
â”‚   â””â”€â”€ processed/               # å¤„ç†åçš„æ•°æ®
â”œâ”€â”€ output/                       # è¾“å‡ºç›®å½•ï¼ˆæ¨¡å‹æƒé‡ã€å›¾è¡¨ç­‰ï¼‰
â”œâ”€â”€ notebooks/                    # Jupyter Notebooks
â”‚   â””â”€â”€ eda.py                   # æ¢ç´¢æ€§æ•°æ®åˆ†æ
â”œâ”€â”€ csiro-biomass/               # åŸå§‹æ•°æ®é›†
â”‚   â”œâ”€â”€ train.csv                # è®­ç»ƒæ•°æ® (357 å¼ å›¾ç‰‡)
â”‚   â”œâ”€â”€ test.csv                 # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ sample_submission.csv    # æäº¤æ ·ä¾‹
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ USAGE.md                      # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ DATASET.md                    # æ•°æ®é›†è¯´æ˜
â”œâ”€â”€ requirements.txt              # ä¾èµ–åŒ…
â”œâ”€â”€ run_baseline.sh               # å¿«é€Ÿè¿è¡Œè„šæœ¬
â”œâ”€â”€ test_setup.py                 # ç¯å¢ƒæµ‹è¯•è„šæœ¬
â””â”€â”€ .gitignore                    # Git å¿½ç•¥æ–‡ä»¶
```

### 2. æ ¸å¿ƒåŠŸèƒ½å®ç°

#### âœ… æ•°æ®é¢„å¤„ç† (`dataset.py`)
- âœ“ é•¿è¡¨åˆ°å®½è¡¨è½¬æ¢ (`prepare_data` å‡½æ•°)
- âœ“ PyTorch Dataset ç±» (`BiomassDataset`)
- âœ“ æ•°æ®å¢å¼º (ç¿»è½¬ã€é¢œè‰²æŠ–åŠ¨ç­‰)
- âœ“ å›¾åƒæ ‡å‡†åŒ– (ImageNet mean/std)

#### âœ… æ¨¡å‹å®šä¹‰ (`model.py`)
- âœ“ ä½¿ç”¨ timm åº“çš„é¢„è®­ç»ƒæ¨¡å‹
- âœ“ æ”¯æŒå¤šç§ backbone (EfficientNet, ResNet)
- âœ“ è¾“å‡º 5 ä¸ªç”Ÿç‰©é‡æŒ‡æ ‡

#### âœ… è®­ç»ƒæµç¨‹ (`train.py`)
- âœ“ å®Œæ•´çš„è®­ç»ƒ/éªŒè¯å¾ªç¯
- âœ“ RMSE æŒ‡æ ‡è®¡ç®—
- âœ“ å­¦ä¹ ç‡è°ƒåº¦å™¨ (ReduceLROnPlateau)
- âœ“ æœ€ä½³æ¨¡å‹ä¿å­˜
- âœ“ è®­ç»ƒå†å²å¯è§†åŒ–

#### âœ… æ¨ç†æµç¨‹ (`inference.py`)
- âœ“ æ‰¹é‡é¢„æµ‹
- âœ“ æŒ‰ target_name ç”Ÿæˆæäº¤æ–‡ä»¶
- âœ“ æ­£ç¡®å¤„ç†é•¿æ ¼å¼æµ‹è¯•é›†

### 3. æ•°æ®é›†ä¿¡æ¯

**è®­ç»ƒé›†ç»Ÿè®¡:**
- æ€»è¡Œæ•°: 1,785 è¡Œ
- å”¯ä¸€å›¾ç‰‡: 357 å¼ 
- æ¯å¼ å›¾ç‰‡ 5 ä¸ªç›®æ ‡å€¼ï¼ˆé•¿æ ¼å¼ï¼‰
- ç›®æ ‡å˜é‡: Dry_Green_g, Dry_Dead_g, Dry_Clover_g, GDM_g, Dry_Total_g

**å…ƒæ•°æ®å­—æ®µ:**
- `Sampling_Date`: é‡‡æ ·æ—¥æœŸ
- `State`: æ¾³å¤§åˆ©äºšå·
- `Species`: ç‰§è‰ç‰©ç§
- `Pre_GSHH_NDVI`: NDVI è¯»æ•°
- `Height_Ave_cm`: å¹³å‡é«˜åº¦

### 4. æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© |
|------|---------|
| æ·±åº¦å­¦ä¹ æ¡†æ¶ | PyTorch 2.6.0 |
| æ¨¡å‹åº“ | timm (PyTorch Image Models) |
| æ•°æ®å¤„ç† | Pandas, NumPy |
| å›¾åƒå¤„ç† | PIL, torchvision |
| å¯è§†åŒ– | Matplotlib, Seaborn |

### 5. æ¨¡å‹é…ç½®

**é»˜è®¤é…ç½®:**
- Backbone: EfficientNet-B0
- è¾“å…¥å°ºå¯¸: 224Ã—224
- Batch Size: 32
- å­¦ä¹ ç‡: 0.001
- ä¼˜åŒ–å™¨: AdamW
- æŸå¤±å‡½æ•°: MSE Loss
- è®­ç»ƒè½®æ•°: 20

**æ”¯æŒçš„æ¨¡å‹:**
- `tf_efficientnet_b0` (é»˜è®¤)
- `resnet18`
- `resnet34`
- `resnet50`

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. æµ‹è¯•ç¯å¢ƒ

```bash
python3 test_setup.py
```

### 3. è¿è¡Œ EDA

```bash
cd notebooks
python3 eda.py
```

### 4. è®­ç»ƒæ¨¡å‹

**æ–¹å¼ä¸€ï¼šä½¿ç”¨è„šæœ¬**
```bash
./run_baseline.sh
```

**æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œ**
```bash
python3 src/train.py \
    --model tf_efficientnet_b0 \
    --epochs 20 \
    --batch_size 32 \
    --pretrained
```

### 5. ç”Ÿæˆæäº¤æ–‡ä»¶

```bash
python3 src/inference.py \
    --test_csv csiro-biomass/test.csv \
    --weights output/best_model.pth \
    --output submission.csv
```

---

## ğŸ“Š é¢„æœŸæ€§èƒ½

**è®­ç»ƒæ—¶é—´ä¼°ç®— (CPU):**
- EfficientNet-B0: ~30-40 åˆ†é’Ÿ/epoch
- ResNet18: ~20-25 åˆ†é’Ÿ/epoch

**è®­ç»ƒæ—¶é—´ä¼°ç®— (GPU):**
- EfficientNet-B0: ~10-15 åˆ†é’Ÿ/epoch
- ResNet18: ~5-8 åˆ†é’Ÿ/epoch

**é¢„æœŸ RMSE:**
- ç¬¬ä¸€ç‰ˆ Baseline: ~15-25 (å–å†³äºæ•°æ®è´¨é‡)
- ç»è¿‡è°ƒä¼˜: ~10-15

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ”¹è¿›æ–¹å‘

### çŸ­æœŸæ”¹è¿› (1-2å¤©)
1. **æ•°æ®å¢å¼ºä¼˜åŒ–**
   - æ·»åŠ æ›´æ¿€è¿›çš„å¢å¼ºç­–ç•¥
   - å®ç° MixUp / CutMix

2. **äº¤å‰éªŒè¯**
   - å®ç° K-Fold éªŒè¯
   - æŒ‰ State æˆ– Date åˆ†ç»„éªŒè¯

3. **é›†æˆå­¦ä¹ **
   - è®­ç»ƒå¤šä¸ªæ¨¡å‹å¹¶å¹³å‡
   - ä¸åŒ backbone çš„é›†æˆ

### ä¸­æœŸæ”¹è¿› (1å‘¨)
1. **ç‰¹å¾å·¥ç¨‹**
   - åˆ©ç”¨ NDVIã€é«˜åº¦ç­‰å…ƒæ•°æ®
   - å¤šæ¨¡æ€èåˆï¼ˆå›¾åƒ + è¡¨æ ¼æ•°æ®ï¼‰

2. **æ¨¡å‹ä¼˜åŒ–**
   - å°è¯•æ›´å¤§çš„æ¨¡å‹ (EfficientNet-B3/B4)
   - ä½¿ç”¨ Transformer (ViT, Swin)

3. **æŸå¤±å‡½æ•°ä¼˜åŒ–**
   - å°è¯• Huber Loss
   - åŠ æƒæŸå¤±ï¼ˆä¸åŒ target ä¸åŒæƒé‡ï¼‰

### é•¿æœŸæ”¹è¿› (2å‘¨+)
1. **é«˜çº§æŠ€æœ¯**
   - Pseudo-Labeling
   - Self-supervised pretraining
   - Test Time Augmentation (TTA)

2. **è¶…å‚æ•°æœç´¢**
   - ä½¿ç”¨ Optuna è¿›è¡Œè¶…å‚æ•°ä¼˜åŒ–
   - AutoML æ–¹æ³•æ¢ç´¢

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®æ ¼å¼**: æµ‹è¯•é›†æ˜¯é•¿æ ¼å¼ï¼Œæ¯å¼ å›¾ç‰‡å¯¹åº” 5 è¡Œï¼Œæ¨ç†æ—¶éœ€è¦æ­£ç¡®æ˜ å°„
2. **å†…å­˜ç®¡ç†**: å¦‚æœ OOMï¼Œå‡å° batch_size æˆ–å›¾åƒå°ºå¯¸
3. **éªŒè¯ç­–ç•¥**: å»ºè®®ä½¿ç”¨ GroupKFold æŒ‰ Location/Date åˆ†ç»„ï¼Œé¿å…æ•°æ®æ³„éœ²
4. **è®¾å¤‡é€‰æ‹©**: CPU è®­ç»ƒä¼šå¾ˆæ…¢ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ GPU

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `src/dataset.py` | æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€æ•°æ®å¢å¼º |
| `src/model.py` | æ¨¡å‹å®šä¹‰ï¼Œä½¿ç”¨ timm åº“ |
| `src/train.py` | è®­ç»ƒè„šæœ¬ï¼ŒåŒ…å«éªŒè¯å’Œä¿å­˜é€»è¾‘ |
| `src/inference.py` | æ¨ç†è„šæœ¬ï¼Œç”Ÿæˆæäº¤æ–‡ä»¶ |
| `notebooks/eda.py` | æ¢ç´¢æ€§æ•°æ®åˆ†æ |
| `test_setup.py` | ç¯å¢ƒæµ‹è¯•è„šæœ¬ |
| `run_baseline.sh` | ä¸€é”®è¿è¡Œè„šæœ¬ |
| `USAGE.md` | è¯¦ç»†ä½¿ç”¨æŒ‡å— |

---

## âœ… æµ‹è¯•ç»“æœ

æ‰€æœ‰ç¯å¢ƒæµ‹è¯•é€šè¿‡ (6/6):
- âœ… åº“å¯¼å…¥
- âœ… PyTorch/CUDA
- âœ… æ•°æ®æ–‡ä»¶
- âœ… æºä»£ç 
- âœ… æ¨¡å‹åˆ›å»º
- âœ… æ•°æ®åŠ è½½

---

## ğŸ¤ è´¡çŒ®

å¦‚éœ€æ”¹è¿›æˆ–æŠ¥å‘Šé—®é¢˜ï¼Œè¯·åˆ›å»º Issue æˆ– Pull Requestã€‚

---

**åˆ›å»ºæ—¶é—´:** 2024-12-01  
**ç‰ˆæœ¬:** 1.0.0  
**çŠ¶æ€:** âœ… Ready for Training
